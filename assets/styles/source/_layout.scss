
@supports (display: grid) {

    @include mq(880px) {
    
        .ntt--entity-main-main-aside---1 {

            .ntt--entity-main-main {
                display: grid;
                grid-template:
                    'entry-md entity-main-main-aside'
                    / 2fr 1fr;
            }
        
            .ntt--entry-md {
                grid-area: entry-md;
            }
        
            .ntt--entity-main-main-aside {
                grid-area: entity-main-main-aside;
            }

            .ntt--entity-main-footer {
                display: grid;
                grid-template:
                    'entity-main-footer .'
                    / 2fr 1fr;
            }

            .ntt--entry-nav {
                grid-area: entity-main-footer;
            }
        }

        .ntt--single-entry {

            &.ntt--entity-main-main-aside---1 {

                .ntt--entity-main-main {
                    grid-template:
                        'entity-main-main-aside entry-md'
                        / 1fr 3fr;
                }

                .ntt--entity-main-footer {
                    grid-template:
                        '. entity-main-footer'
                        / 1fr 3fr;
                }
            }
        }
    }
}

.ntt--entity-main-header {
    padding-top: 2rem;
}

.ntt--entry {
    @include y-padding(2rem);
}

.ntt--widget {
    @include y-padding(1rem);
}

.ntt--widget-name {
    @include y-padding(1rem);
    @include y-margin();
}

//--------------------------------------------------------------
// Comment Form
//--------------------------------------------------------------

.ntt--comment-form {

    .ntt--form-field {
        position: relative;

        label {
            position: absolute;
            margin-left: calc(1.25rem + 1px);
            margin-top: calc(1.75rem + 1px);
            @include transition;

            @at-root .js.ntt--dom---unloaded & {
                visibility: hidden;
            }
            
            @at-root .js.ntt--dom---loaded & {
                visibility: visible;
            }

            .ntt--txt {
                padding: 0;
                
                > * {
                    vertical-align: middle;
                }
            }
        }

        &:focus-within,
        &.ntt--form-field---populated--js {

            label {
                margin-top: 1rem;
                font-size: $text---sm;
                color: $mid-color;
            }
        }

        .text-input {
            min-height: 4rem;
            padding-top: 2rem;
            text-overflow: ellipsis;

            &::placeholder {
                color: transparent;
            }
        }
    }

    .ntt--required-txt {
        display: none;
    }

    .ntt--optional-txt {
        padding: .25rem .5rem;
        font-size: $text---xs;
        color: $mid-color;
        text-transform: uppercase;
        background-color: $on-surface-color---alpha-lo;
        border-radius: $corner-radius---sm;
    }

    // If user is logged in
    .ntt--user---admin & {
        position: relative;

        .form-submit {
            position: absolute;
            right: 0;
            bottom: 0;
            margin-right: 2rem;
            margin-bottom: 2rem;

            input[type="submit"] {
                margin: 0;
            }
        }

        textarea {
            padding-right: 7.5rem;
        }
    }
}

//--------------------------------------------------------------
// Content Module - Author Avatar
//--------------------------------------------------------------

.ntt--cm-author-avatar {
 
    .ntt--img {
        border-radius: 50%;
        overflow: hidden;
    }
}

//--------------------------------------------------------------
// Entry Navigation
//--------------------------------------------------------------

.ntt--entry-nav-name {
    font-size: $text---xl;
}

.ntt--entity-header {
    @include transition;
}

//--------------------------------------------------------------
// Sticky Header - JS
// Data Scroll Y - JS
//--------------------------------------------------------------

.ntt--js--sticky-header {

    &.ntt--sticky-header---active--js {

        &[data-scroll-y-percentage] {

            .ntt--entity-header {

                // Page Length Progress Bar
                &::after {
                    content: '';
                    position: fixed;
                    left: 0;
                    top: 0;
                    height: .125rem;
                    width: 0%;
                    background-color: transparent;
                    @include transition;
                    opacity: .5;
                    transform: translate3d(0px, 0px, 0px);
                }
            }
        }

        @for $i from 5 through 100 {

            @if $i % 1 == 0 {
                $width: percentage($i / 100);
                $hue: $i * 3.6;
            
                &[data-scroll-y-percentage~="#{$i}"] {

                    .ntt--entity-header {

                        &::after {
                            width: $width;
                            background-color: hsla($hue, 100%, 50%, .5);
                        }
                    }
                }
            }
        }

        .ntt--entity-heading {
            @include y-padding();
        }

        .ntt--entity-header {
            display: flex;
            align-items: center;
            grid-template:
                'entity-heading entity-primary-nav';
            width: 100%;
            position: fixed;
            top: 0;
            z-index: 1;
            background-color: white;
            animation-name: fade-in;
            animation-duration: .2s;

            // Shadow
            &::before {
                content: '';
                position: absolute;
                left: 0;
                top: 100%;
                width: 100%;
                height: .5rem;
                // https://www.colorzilla.com/gradient-editor/#000000+0,ffffff+100&1+0,0+100
                background: -moz-linear-gradient(top,  hsla(0,0%,0%,1) 0%, hsla(0,0%,100%,0) 100%);
                background: -webkit-linear-gradient(top,  hsla(0,0%,0%,1) 0%,hsla(0,0%,100%,0) 100%);
                background: linear-gradient(to bottom,  hsla(0,0%,0%,1) 0%,hsla(0,0%,100%,0) 100%);
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#000000', endColorstr='#00ffffff',GradientType=0 );
                opacity: .125;
            }
        }

        .ntt--entity-description {
            display: none;
        }

        @keyframes fade-in {
            from {
                opacity: 0;
            }
        
            to {
                opacity: 1;
            }
        }

        .ntt--nav---sub-menu--js {

            > div > ul > li > .ntt--sub-menu--js {
                margin-top: -.25rem;
            }
        }
    }
}

.ntt--js--data-scroll-y {
    
    &[data-scroll-y-percentage]:before {
        content: '';
        position: fixed;
        left: 0;
        top: 0;
        height: .125rem;
        width: 0%;
        background-color: transparent;
        @include transition;
        opacity: .5;
        transform: translate3d(0px, 0px, 0px);
    }

    @for $i from 5 through 100 {

        @if $i % 1 == 0 {
            $width: percentage($i / 100);
            $hue: $i * 3.6;
        
            &[data-scroll-y-percentage~="#{$i}"]:before {
                width: $width;
                background-color: hsla($hue, 100%, 50%, .5);
            }
        }
    }
}



.ntt--post--table-of-contents--view {

    .ntt--entry-full-content {

        nav {
            position: fixed;
            right: 0;
            top: 0;
            background-color: aliceblue;

            a {
                @include transition;
                transition-duration: 2s;
            }

            .ntt--intersected--js {
                background-color: red;
            }
        }
    }
}

.ntt--entity-footer {
    opacity: 0;
    @include transition;
    transition-duration: 2s;

    &.ntt--intersected--js {
        opacity: 1;
    }
}

section {
    @include transition;
    transition-delay: .2s;
    transition-duration: 1s;
}

section.ntt--not-intersected--js {
    opacity: 0;
}

section.ntt--intersected--js {
    opacity: 1;
}

section:target {
    animation-name: target-fade;
    animation-duration: 2s;

    @keyframes target-fade {
        from {
            background-color: transparent;
        }

        50% {
            background-color: $accent-color---alpha-lo;
        }

        to {
            background-color: transparent;
        }
    }
}